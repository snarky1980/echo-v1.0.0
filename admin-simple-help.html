<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aide — Console simple</title>
    <meta name="robots" content="noindex, nofollow" />
    <style>
      :root { --border:#e2e8f0; --muted:#64748b; --ink:#0f172a; --teal:#059669; }
      *{box-sizing:border-box}
      body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f8fafc;color:var(--ink)}
      header{position:sticky;top:0;display:flex;align-items:center;gap:8px;padding:10px;border-bottom:1px solid var(--border);background:#fff}
      .title{font-weight:800}
      .spacer{flex:1}
      .btn{border:1px solid var(--border);background:#fff;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer}
      .btn.primary{background:var(--teal);border-color:var(--teal);color:#fff}
      main{padding:16px;max-width:900px;margin:0 auto}
      .chip{display:inline-block;background:#ecfeff;color:#0e7490;border:1px solid #bae6fd;padding:2px 8px;border-radius:999px;font-size:12px;font-weight:700}
      h2{margin:10px 0}
      h3{margin:10px 0}
      .card{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,.06);padding:14px}
      code{background:#f1f5f9;border:1px solid var(--border);border-radius:6px;padding:0 4px}
      ol{margin:0 0 12px 18px}
      ul{margin:0 0 0 18px}
      footer{padding:12px;color:var(--muted);text-align:center}
      @media (max-width: 700px){ main{padding:12px} }
    </style>
  </head>
  <body>
    <header>
      <div class="title">Aide — Modifier un modèle (sans programmation)</div>
      <div class="spacer"></div>
      <button class="btn" onclick="window.close()">Fermer</button>
    </header>
    <main>
      <div class="card" style="margin-bottom:12px">
        <div class="chip">Conseil</div>
        <div style="margin-top:6px">Tout est enregistré en brouillon local. « Réinitialiser » supprime le brouillon et recharge le fichier d’origine.</div>
      </div>
      <section class="card" style="margin-bottom:12px">
        <h3>Option A — Modification rapide (dans la page)</h3>
        <ol>
          <li>Recherchez puis sélectionnez le modèle dans la liste (colonne de gauche).</li>
          <li>Basculez la langue (FR/EN) en haut si nécessaire.</li>
          <li>Modifiez <em>Titre</em>, <em>Description</em>, <em>Objet</em> et <em>Corps</em>.</li>
          <li>Cliquez « Sync variables » pour détecter les <code>&lt;&lt;variables&gt;&gt;</code> dans Objet/Corps.</li>
          <li>Cliquez « Ajouter variables manquantes » pour les ajouter au catalogue (bibliothèque de variables).</li>
          <li>Exportez : « Exporter JSON » (ou « Exporter Excel ») pour partager vos changements.</li>
        </ol>
      </section>
      <section class="card" style="margin-bottom:12px">
        <h3>Option B — Avec Excel (plusieurs modèles)</h3>
        <ol>
          <li>Cliquez « Exporter Excel » pour obtenir l’état actuel en .xlsx.</li>
          <li>Ouvrez le fichier dans Excel, modifiez ou ajoutez des lignes.
            <ul>
              <li>Conservez la syntaxe des variables : <code>&lt;&lt;NomVariable&gt;&gt;</code> (ex : <code>&lt;&lt;ProjectNumber&gt;&gt;</code>).</li>
              <li>L’ID doit être unique (lettres/chiffres/souligné). Si doublon, l’import ajoutera un suffixe.</li>
            </ul>
          </li>
          <li>Enregistrez puis « Importer Excel » dans la console simple pour charger vos changements.</li>
          <li>Vérifiez la liste et faites des corrections au besoin ; tout reste en brouillon.</li>
          <li>Exportez en JSON pour finaliser ou transmettre.</li>
        </ol>
      </section>
      <section class="card">
        <h3>FAQ rapide</h3>
        <ul>
          <li><strong>Colonnes Excel manquantes</strong> — utilisez « Modèle XLSX/CSV » pour repartir d’un gabarit valide.</li>
          <li><strong>Variables</strong> — la liste se remplit à partir des textes (Objet/Corps). Ajoutez ensuite leurs descriptions dans le catalogue.</li>
          <li><strong>Publication</strong> — exportez le JSON et partagez-le, ou ouvrez le « Mode complet » si disponible.</li>
        </ul>
      </section>
    </main>
    <footer>Astuce : vous pouvez garder cette fenêtre ouverte pendant que vous travaillez.</footer>
    <script>
      // Focus the window, hint for accessibility
      window.focus?.();
    </script>
  </body>
  </html>
